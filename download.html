<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>珠城先锋网</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/news.css">

  <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="js/config.js"></script>
  <script type="text/javascript" src="js/api.js"></script>
</head>
<!-- Internet Explorer 已限制此网页运行脚本或ActiveX控件的解决方法 -->
<!-- saved from url=(0014)about:internet -->
<body>
  <div id="app">
    <nav class="flex-style row">
      <div class="flex-style row">
        <span>欢迎光临珠城先锋网, 今天是2016年04月20日</span>
        <div class="search">
          <input type="text" placeholder="请输入关键词搜索" name="" id="" value="" />
          <button><i>搜索</i></button>
      </div>
      </div>
    
      <div>
        <a href="#">设为首页 |</a>
        <a href="#">加入收藏 |</a>
        <a href="#">意见反馈 |</a>
        <a href="#">手机APP下载</a>
        
      </div>
      
    </nav>
    
    <div class="content clearfix">
      <section class="clearfix">
        
        <div class="flex-cstyle row shine-group">
          <div id="topName"></div>
          <div style="width: 90%; text-align: center;" id="topList">
            
          </div>
          
        </div>
        <div class="bottom-line"></div>
        <div class="sec-top">
          <span>首页</span>>
          <span>阳光组工</span>>
          <span>党建工作</span>
        </div>
        <div class="section" style="width:67%">
          <div class=" flex-cstyle row shine-content
        ">
              <div class="shine-set" >
                <div class="flex-cstyle row shine-title" id="setNewList">
                  <div id="topTitle"></div>
                  <!-- <span class="more">更多>></span> -->
                </div>
                
                <!-- <div class="main-new" >
                  <a href=""><h3>济南市抗疫一线培养和发展党员纪实</h3></a>
                  
                  <div class="flex-cstyle row main-content" >
                    <img v-show="see" class="max" src="./images/celect.jpg" alt="">
                    <div class="shine-detail save">
                      <a href="">
                        <p style="text-indent:2em; color: #3c3c3c;">召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"召开全县 "两学一做"学习教育工作会议, 深入贯彻习近平总书记关于"两学"</p>
                      <a href="#">[详情]</a>
                      </a>
                      
                    </div>
                  </div>
                </div> -->
    
                     
              </div>
    
           
          </div>
          
        
        </div>
        <aside style="width:30%; margin-top: 25px;">
          <div class="shine-set shine-left" >
            <div class="flex-cstyle row" style="padding: 15px 10px; background-color: #F5F5F5;">
              <img src="./images/celect.jpg" alt="">
              <div class="shine-detail">
                <h3>
                  北海先锋
                </h3>
                <button type="button">立即收听</button>
              </div>
              
    
            </div>
            <div style="line-height: 23px; padding: 0px 10px;">
              #先锋新闻# 专稿 : 近年来 , 北海以"四个推手" 为抓手, 通过推动全覆盖, 规范化, 三帮带, 示范引领等多措并举, 有效促进该区非公企业党建工作由被动为主动的转变, 实现非公党建水平的整体提升.
            </div>
            <img src="./images/celect.jpg" alt="" style="width:100%; height: 175px;padding: 0px 10px;">
          <div class="flex-rstyle " style="height: 35px;color: #969696;line-height: 37px; padding: 0px 10px;">
              <span>3月25日 18:11 来着网页</span>
              <div class="say"><img src="./images/say.png" alt="">(12565)</div>
            </div>
          </div>
    
          <div class="shine-bottom">
            <div class="flex-cstyle row shine-title" style="background-image: url(./images/video.png); ">
              <div style="font-weight: 400; font-size: 15px;">党建视频</div>
              <span class="more">更多>></span>
            </div>
            <div class="mid-pic">
              <img src="./images/celect.jpg" alt="">
            </div>
          </div>
        </aside>
        
      </section>
      
    
    
      <section class="clearfix">
        <div class="flex-cstyle row links">
          <div>
            <span class="link-title">友情链接</span>
            <span style="color: #969696;font-size: 13px; ">Links</span>
            </div>
         
          <div class="webs">
            <span class="webs-selected">党建网站</span>
            <span>综合网站</span>
            <span>报刊网站</span>
          </div>
        </div>
          <ul class="flex-style row websites">
            <li><a href="#">共产党员网</a></li>
            <li><a href="#">中共中央组织部</a></li>
            <li><a href="#">中国党建网</a></li>
            <li><a href="#">中国共产党新闻网</a></li>
            <li><a href="#">党史党建在线</a></li>
            <li><a href="#">全国远程教育网</a></li>
            <li><a href="#">北京组工</a></li>
            <li><a href="#">新浪网</a></li>
          </ul>
         
        
      </section>
    </div>
    
    <footer >
      <div>
        <a href="#">联系我们</a>|
        <a href="#">网站地图</a>|
        <a href="#">法律申明</a>|
        <a href="#">投诉信箱</a>|
        <a href="#">免责申明</a>
        
      </div>
      <div>中共北海市委组织部主办</div>
      <div>地址 : 广西市合平路东二巷2号 邮编 : 53600</div>
      <div>桂公网安备 450502020000014号</div>
      <img src="./images/bottom.png" alt="">
    </footer>
  </div>


    

<script>
 $(function(){
      //获取url中的参数  
      function getUrlParam(name) {   
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象  
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数   
        if (r != null) return unescape(r[2]); return null; //返回参数值  
   } 

    var uId=getUrlParam("id");
    var pId=getUrlParam("pId");
      console.log(uId)

    //获取顶部栏 
    getTopList();
    // 获取子栏目内容
    if(uId != 0){
      getSetList();
    }else{
      // 获取最新下载
      getNewDownload();
    }
    
  //获取顶部栏 
    function getTopList(){
      var result=ajaxMethod('topSet',pId);
      console.log(result)
    
        if (result.code == 0 && result.data != null) {
            //do something
            var data = result.data[0];
            console.log(data)
          //  $('#topName').html(data.catalogName);
           document.getElementById("topName").innerHTML = data.catalogName;
           var set='';
           if(data.children.length>0){
            
               data.children.forEach(function(value, index ){
                 console.log(value)
                 if(value.id == uId){
                  // $('#topTitle').html(value.catalogName);
                  document.getElementById("topTitle").innerHTML = value.catalogName;
                 }
                 if(index == 0){
                  var srt='<a href="./download.html?id='+value.id+'&pId='+pId+'" data-id="'+value.id+'" target="_blank" >'+value.catalogName+'</a>';
                 }else{
                  var srt='|<a href="./download.html?id='+value.id+'&pId='+pId+'" data-id="'+value.id+'" target="_blank" >'+value.catalogName+'</a>';
                 }
                 
                 set += srt
 
                 
               })
               console.log(set)
              //  $('#topList').html(set);
               
                
           }else{
            document.getElementById("topTitle").innerHTML = data.catalogName;
           }
           document.getElementById("topList").innerHTML = set;
           
               
            
        } else {
            //do something
        }
    }

    function getSetList(){
      
      let that = this;
      var data = {
        catalogId:uId
    }
    var result=ajaxMethod('newList','',data);
    console.log(result)
    
        if (result.code == 0 && result.data != null) {
            //do something
            
          var list = result.data.records;
          var set='';
          list.forEach(function(value, index ){
                 console.log(value)

                 var first = value.content.indexOf('<p');
                var last = value.content.indexOf('</p>') + 4;
                var cont =value.content.slice(first, last);
                console.log(cont)
                
                 if(value.titlePic){
                  var pic = filePath + value.titlePic;
                  var srt='<div class="main-new" >'+
                  '<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'"><h3>'+value.title+'</h3></a>'+
                  '<div class="flex-cstyle row main-content" >'+
                    '<img  class="max" src="'+pic+'" alt="">'+
                    '<div class="shine-detail save">'+cont+'<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'">[详情]</a>  </div></div></div>';
                 }else{
                  var srt='<div class="main-new" >'+
                  '<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'"><h3>'+value.title+'</h3></a>'+
                  '<div class="flex-cstyle row main-content" >'+
                    '<div class="shine-detail save">'+cont+'<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'">[详情]</a>  </div></div></div>';
                 }
                 set += srt
 
                 
               })
               $('#setNewList').after(set);   
              
            
        } else {
            //do something
        }
    }

    // 获取最新下载
    function getNewDownload(){

    }

    
 })

</script> 
</body>
</html>
