<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <meta http-equiv="x-ua-compatible" content="IE=EmulateIE8">
  <meta http-equiv="x-ua-compatible" content="IE=EmulateIE9">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1">
  <!-- <meta name="renderer" content="webkit|ie-comp|ie-stand"> -->
  <title>珠城先锋网</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/news.css">
  <style>



  </style>
  <!--[if !IE]> -->
  <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
  <!-- <![endif]-->
  
  <!--[if IE 9]>
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://cdn.static.runoob.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
<![endif]-->

<!--[if IE 8]>
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>

<script src="http://cdn.static.runoob.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
<![endif]-->
  <link rel="stylesheet" href="css/app.min.css">
  <!-- <script type="text/javascript" src="js/app.min.js"></script> -->

  <script type="text/javascript" src="js/jq-paginator.js"></script>
  <script type="text/javascript" src="js/config.js"></script>
  <script type="text/javascript" src="js/api.js"></script>
  <script type="text/javascript" src="js/common.js"></script>
</head>
<!-- Internet Explorer 已限制此网页运行脚本或ActiveX控件的解决方法 -->
<!-- saved from url=(0014)about:internet -->

<body id="some-element">
  <div id="app">
    <nav class="flex-style row">
      <div class="flex-style row fl" style="margin-left: 150px;">
        <span class="fl">欢迎光临珠城先锋网, 今天是<span id="nowTime">2020年03月23日</span></span>
        <div class="search fr" >
          <input class="fl" type="text" placeholder="请输入关键词搜索" name="" id="searchInput" value="" />
          <button id="search"><i>搜索</i></button>
        </div>
      </div>

      <div class="fr" style="margin-right: 150px;">
        <a href="javascript:setHome(this,window.location);" id="text">设为首页 |</a>
        <a href="#" id="setFavorite" onclick="AddFavorite(window.location,document.title)"
          href="javascript:void(0);">加入收藏 </a>
        <!-- <a href="./login.html" target="_blank">登录</a> -->

        <!-- <a href="#">意见反馈 |</a>
      <a href="#">手机APP下载</a> -->

      </div>

    </nav>
     <!-- 顶部栏目 -->
     <section class="content-top row flex-cstyle" >
      <div class="top">
         <ul id="contentTop">
           </ul> 
      </div>
    </section>

    <div class="content clearfix">
     

      <section class="clearfix">

        <div class="flex-cstyle row shine-group">
          <div id="topName" class="fl"></div>
          <div style="width: 85%; text-align: center;float: left;" id="topList">

          </div>

        </div>
        <div class="bottom-line"></div>
        <div class="sec-top" id="step">
          <a href="./index.html" target="_blank">首页</a>>
          <!-- <a href="#" target="_blank" id="sedStep"></a> -->
          <span id="sedStep"></span>

        </div>
        <div class="section" style="width:67%">
          <div class=" flex-cstyle row shine-content
        ">
            <div class="shine-set4">
              <div class="flex-cstyle row shine-title" id="setNewList">
                <div id="topTitle"></div>
                <!-- <span class="more">更多>></span> -->
              </div>
              <div style="width: 100%; height: 100%;" id="setNewListHold">
                暂无相关内容
              </div>

            </div>


          </div>


        </div>
        <aside style="width:30%; margin-top: 25px;">
          <div class="shine-set shine-left">
            <div class="flex-cstyle row shine-leftIcon" style="padding: 15px 10px; background-color: #F5F5F5;">
              <img src="./images/u5.jpg" alt="">
              <div class="shine-detail">
                <h3>
                  北海先锋
                </h3>
                <a href="http://e.weibo.com/beihaizzb" target="_blank">
                  <button type="button" >立即收听</button>
                </a>
                
              </div>


            </div>
            <div style="line-height: 23px; padding: 0px 10px;">
              #先锋新闻# 专稿 : 近年来 , 北海以"四个推手" 为抓手, 通过推动全覆盖, 规范化, 三帮带, 示范引领等多措并举, 有效促进该区非公企业党建工作由被动为主动的转变, 实现非公党建水平的整体提升.
            </div>
            <a href="http://weibo.com/beihaizzb?refer_flag=1005055014_&is_all=1#_rnd1470278615323http://weibo.com/p/100808ddd6e5a81db6a9771819aff1de6df551?k=先锋播报&from=501&_from_=huati_topic" target="_blank">
              <img src="./images/u6.jpg" alt="" style="width:100%; height: 175px;padding: 0px 10px;">
            </a>
            
            <div class="flex-rstyle " style="height: 35px;color: #969696;line-height: 37px; padding: 0px 10px;">
              <span>3月25日 18:11 来着网页</span>
              <div class="say"><img src="./images/pinglun.jpg" alt="">(12565)</div>
            </div>
          </div>

          <div class="shine-bottom">
            <div class="flex-cstyle row shine-title" style="background-image: url(./images/video.png); ">
              <div style="font-weight: 400; font-size: 15px;">党建视频</div>
              <a href="./moreBook.html?type=1" class="more" target="_blank">更多>></a>
            </div>
            <div class="mid-pic clearfix" id="toVideo">
              <a href="" target="_blank"><img src="./images/tv_tu.jpg" alt=""></a>

            </div>
          </div>
        </aside>

      </section>
      <div class="demo customBootstrap">
        <!-- <p>当前第 <span id="demo2-text"></span> 页</p> -->
        <ul id="demo2" class="pagination"></ul>
      </div>

      <section class="clearfix">
        <div class="flex-cstyle row links">
          <div class="fl">
            <span class="link-title">友情链接</span>
            <span style="color: #969696;font-size: 13px; ">Links</span>
          </div>

          <div class="webs fr">
            <span class="" data-type="1" style="background:#FAF9F5;">党建网站</span>
            <span  data-type="2">综合网站</span>
            <span  data-type="3">报刊网站</span>
          </div>
        </div>
        <ul class=" websites site1">
          <li><a href="http://www.12371.cn" target="_blank">共产党员网</a></li>
        
          <li><a href="http://cpc.people.com.cn/GB/64114/75347/" target="_blank">中共中央组织部</a></li>
           
          <li><a href="http://www.dangjiancn.com/" target="_blank">中国党建网</a></li>
           
          <li><a href="http://cpc.people.com.cn/" target="_blank">中国共产党新闻网</a></li>
           
          <li><a href="http://www.ccphistory.org.cn/" target="_blank">党史党建在线</a></li>
           
          <li><a href="http://www.dygbjy.gov.cn" target="_blank">全国远程教育网</a></li>
           
          <li><a href="http://www.bjdj.gov.cn/viewpubarticle.do?id=123393" target="_blank">北京组工</a></li>
           
          <li><a href="http://www.jszzb.gov.cn/" target="_blank">江苏党建</a></li>
        </ul>
        <ul class=" websites site2" style="display: none;">
          <li><a href="http://www.sohu.com/" target="_blank">搜狐网</a></li>
        
          <li><a href="http://www.sina.com.cn/" target="_blank">新浪网</a></li>
            
          <li><a href="http://www.china.com.cn/" target="_blank">中国网</a></li>
            
          <li><a href="http://www.people.com.cn/" target="_blank">人民网</a></li>
            
          <li><a href="http://www.xinhua.org/" target="_blank">新华网</a></li>
            
          <li><a href="http://www.china.com/zh_cn/" target="_blank">中华网</a></li>
            
          <li><a href="http://www.cntv.cn/" target="_blank">CCTV</a></li>

          
        </ul>
        <ul class="websites site3" style="display: none;">
          <li><a href="http://www.gxnews.com.cn/" target="_blank">广西新闻网</a></li>
        
          <li><a href="http://paper.people.com.cn/rmrb/html/2012-05/14/nbs.D110000renmrb_01.htm" target="_blank">人民日报</a></li>
           
          <li><a href="http://zjdaily.zjol.com.cn" target="_blank">浙江日报</a></li>
           
          <li><a href="http://epaper.cnnb.com.cn/rp/clt/newreader" target="_blank">宁波日报</a></li>
           
          <li><a href="http://www.chinadaily.com.cn/" target="_blank">中国日报</a></li>
           
          <li><a href="http://www.zuzhirenshi.com/dianzibao/index.htm" target="_blank">组织人事报</a></li>
           
          <li><a href="http://www.admaimai.com/newspaper/Detail10_1565.htm" target="_blank">光明日报</a></li>
          
        </ul>


      </section>
    </div>

    <footer style="color:rgb(60, 60, 60);text-align: center;">
      <!-- <div>
        <a href="#">联系我们</a>|
        <a href="#">网站地图</a>|
        <a href="#">法律申明</a>|
        <a href="#">投诉信箱</a>|
        <a href="#">免责申明</a>

      </div> -->
      <div>中共北海市委组织部主办</div>
      <div>地址 : 广西市合平路东二巷2号 邮编 : 53600</div>
      <div><a href="http://www.beian.gov.cn/portal/registerSystemInfo" target="_blank" style="padding: 0px;">桂公网安备 450502020000014号</a>&nbsp;&nbsp;<a href="http://www.miibeian.gov.cn" target="_blank" style="padding: 0px;">桂ICP备06006473号-1</a></div>
      <a href="http://bszs.conac.cn/sitename?method=show&id=11231DF6641C21ECE053022819AC104A" target="_blank">
        <img src="./images/u12.jpg" alt="">
      </a>
    </footer>
  </div>




  <script>
    $(function () {

      //获取url中的参数  
      function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象  
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数   
        if (r != null) return unescape(r[2]); return null; //返回参数值  
      }

      var totalPage = 1;

      // $("#search").on('click', function () {
      //   window.open('./search.html', "");
      // });


      var uId = getUrlParam("id");
      var pId = getUrlParam("pId");
      var type = getUrlParam("type") || '';
      var flag = 0;
      // type=0是最新下载 1是党务问答
      console.log(uId)
      //获取顶部栏 
      getTopList();
      // 获取党建视频
      getVideo();
      // 获取子栏目内容

      if (uId != 0) {

        getSetList(1);
      } else {
        // 获取最新下载
        getDownload(1);
      }

      //  初始化分页
      $("#demo2").jqPaginator({
        totalPages: totalPage,
        visiblePages: 10,
        currentPage: 1,
        first: '<li class="first"><a href="javascript:void(0);">首页<\/a><\/li>',
        prev: '<li class="prev"><a href="javascript:void(0);">上一页<\/a><\/li>',
        next: '<li class="next"><a href="javascript:void(0);">下一页<\/a><\/li>',
        last: '<li class="last"><a href="javascript:void(0);">末页<\/a><\/li>',
        page: '<li class="page"><a href="javascript:void(0);">{{page}}<\/a><\/li>',
        onPageChange: function (n) {
          // $("#demo2-text").html(n);
          // if(n !=1){
          $('html,body').animate({ scrollTop: 200 }, 'slow');
          console.log(flag)
          if (flag != 1) {
            
            if (uId != 0) {
              getSetList(n);
            } else {
              // 获取最新下载
              getDownload(n);
            }
          }else{
            flag += 1;
          }

          // }
        }
      })

      //获取顶部栏 
      function getTopList() {

        if (uId != 0) {
          var result = ajaxMethod('topSet', pId);
          console.log(result)

          if (result.code == 0 && result.data != null) {
            //do something
            var data = result.data[0];
            console.log(data)
            //  $('#topName').html(data.catalogName);
            document.getElementById("topName").innerHTML = data.catalogName;
            document.getElementById("sedStep").innerHTML = data.catalogName;
            var set = '';
            if (data.children.length > 0) {

              data.children.forEach(function (value, index) {
                console.log(value)
                if (value.id == uId) {
                  // $('#topTitle').html(value.catalogName);
                  document.getElementById("topTitle").innerHTML = value.catalogName;

                }
                var url = './news.html?id=' + value.id + '&pId=' + pId;
                if (value.catalogName == "党建视频") {
                  url = './moreBook.html?type=1';
                }
                if (value.catalogName == "资料下载") {
                  url = './news.html?id=0&pId=0&type=0';
                }
                if (value.catalogName == "党务回答") {
                  url = './news.html?id=0&pId=0&type=1';
                }
                if (value.catalogName == "部长信箱") {
                  url = 'mailto:bhzzbbz@163.com';
                      
                }
                if (index == 0) {
                  var srt = '<a href="' + url + '" data-id="' + value.id + '" target="_blank" >' + value.catalogName + '</a>';
                } else {
                  var srt = '|<a href="' + url + '" data-id="' + value.id + '" target="_blank" >' + value.catalogName + '</a>';
                }

                set += srt;


              })
              console.log(set)
              //  $('#topList').html(set);


            } else {
              document.getElementById("topTitle").innerHTML = data.catalogName;
            }
            document.getElementById("topList").innerHTML = set;



          } else {
            //do something
          }
        } else {

          if (type != 0) {
            document.getElementById("topName").innerHTML = '互动服务';
            document.getElementById("sedStep").innerHTML = '党务回答';
            document.getElementById("topTitle").innerHTML = '党务回答';
          } else {
            document.getElementById("topName").innerHTML = '互动服务';
            document.getElementById("sedStep").innerHTML = '资料下载';
            document.getElementById("topTitle").innerHTML = '资料下载';

          }

        }

      }

      function getSetList(page) {
        flag += 1;
        var that = this;
        var data = {
          catalogId: uId,
          current: page,
          size: 10
        }

        var result = ajaxMethod('newList', '', data);
        console.log(result)

        if (result.code == 0 && result.data != null) {
          //do something
          if (result.data.size > result.data.total) {
            totalPage = 1;
          } else {
            totalPage = Math.ceil(result.data.total / result.data.size);
            console.log(totalPage);
          }
          var list = result.data.records;
          var set = '';
          $('#setNewListHold').html(set);
          if(list.length == 0 && page == 1){
            $('#setNewListHold').html('<h3 class="noneRes">暂无相关内容</h3>');
            return;
          }
          list.forEach(function (value, index) {
       
   
            if (value.titlePic) {
              var pic = filePath + value.titlePic;
              var srt = '<div class="main-new new-pic" >' +
                '<a target="_blank" href="./newDetail.html?id=' + value.id + '&pId=' + uId + '"><img  class="max" src="'+pic+'" alt="">'+
                '<div class="new-tit"><h3>' + value.title + '</h3></a>' +
                // '<div class="flex-cstyle row main-content" >' +

                '<div class="shine-detail save">' + value.creatTs + '</div></div></div>'

              // '<div class="shine-detail save">'+cont+'<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'">[详情]</a>  </div></div></div>';
            } else {
              var srt = '<div class="main-new" >' +
                '<a target="_blank" href="./newDetail.html?id=' + value.id + '&pId=' + uId + '"><h3>' + value.title + '</h3></a>' +
                '<div class="flex-cstyle row main-content" >' +
                '<div class="shine-detail save">' + value.creatTs + '  </div></div></div>';
              // '<div class="shine-detail save">'+cont+'<a target="_blank" href="./newDetail.html?id='+value.id+'&pId='+pId+'">[详情]</a>  </div></div></div>';
            }
            set += srt;

          })
          $('#setNewListHold').html(set);



        } else {
          //do something
        }
      }

      // 获取最新下载
      function getDownload(page) {
        flag += 1;

        var that = this;
        var data = {
          catalogId: uId,
          current: page,
          size: 10
        }
        if (type != 0) {
          // QA问答
          var url = 'question';
          var result = ajaxMethod(url, '', data);
          // console.log(result)
          if (result.code == 0 && result.data != null) {
            //do something
            var resultList = result.data.records;
            var set = '';
            $('#setNewListHold').html(set);
            resultList.forEach(function (value, index) {
              // console.log(value)
              var url = './bookList.html?id='+value.id+'&pId=0&type=1';
              var srt = '<div class="main-new" >' +
                '<a target="_blank" href="' + url + '"><h3>' + value.questions + '</h3></a>' +
                '<div class="flex-cstyle row main-content" >' +

                '<div class="shine-detail save">' + value.createdDate + '  </div></div></div>';

              set += srt;


            })

            $('#setNewListHold').html(set);



          } else {
            //do something
          }
        } else {
          // 最新下载
          var url = 'downloadList';
          var result = ajaxMethod(url, '', data);
          // console.log(result)
          if (result.code == 0 && result.data != null) {
            //do something
            var resultList = result.data.records;
            var set = '';
            $('#setNewListHold').html(set);
            resultList.forEach(function (value, index) {
              // console.log(value)
              var url = filePath + value.filePath;
              var srt = '<div class="main-new" >' +
                '<a target="_blank" href="' + url + '"><h3>' + value.title + '</h3></a>' +
                '<div class="flex-cstyle row main-content" >' +

                '<div class="shine-detail save">' + value.createdDate + '  </div></div></div>';

              set += srt;


            })

            $('#setNewListHold').html(set);



          } else {
            //do something
          }
        }

      }


            // 获取视频
        function getVideo() {
          var that = this;
          var result = ajaxMethod('partyVideo', '');
          // console.log(result)
          if (result.code == 0 && result.data.records.length>0) {
            //do something
            // // console.log('11111');
            // console.log(result.data);
            // console.log(result.data.records[0].id);
            // console.log($("#toVideo a"));
            if (result.data.records.length > 0) {
              console.log('444')
              if(result.data.records[0].sourceType =='no'){
                $("#toVideo a").attr('href', result.data.records[0].videoPath);
              }else{
                $("#toVideo a").attr('href', './video.html?id=' + result.data.records[0].id);
              }
              
              // $("#toVideo img").attr('src', './images/tv_tu.jpg');
            }


          } else {
            //do something
          }

      }


    })

  </script>
</body>

</html>