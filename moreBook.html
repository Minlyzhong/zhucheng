<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>珠城先锋网</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/news.css">
  <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
  <link rel="stylesheet" href="css/app.min.css">
  <script type="text/javascript" src="js/app.min.js"></script>
  
  <script type="text/javascript" src="js/jq-paginator.js"></script>
  <script type="text/javascript" src="js/config.js"></script>
  <script type="text/javascript" src="js/api.js"></script>
  <script type="text/javascript" src="js/common.js"></script>
</head>
<!-- Internet Explorer 已限制此网页运行脚本或ActiveX控件的解决方法 -->
<!-- saved from url=(0014)about:internet -->
<body id="some-element">
  <div id="app">
    <nav class="flex-style row">
      <div class="flex-style row">
        <span>欢迎光临珠城先锋网, 今天是<span id="nowTime">2020年03月23日</span></span>
        <div class="search">
          <input type="text" placeholder="请输入关键词搜索" name="" id="" value="" />
          <button><i>搜索</i></button>
      </div>
      </div>
    
      <div>
        <a href="javascript:setHome(this,window.location);" id="text" >设为首页 |</a>
      <a href="#" id="setFavorite" onclick="AddFavorite(window.location,document.title)"  href="javascript:void(0);">加入收藏 </a>
        <!-- <a href="#">意见反馈 |</a>
        <a href="#">手机APP下载</a> -->
        
      </div>
      
    </nav>
    
    <div class="content clearfix">
      <section class="clearfix">
        
        <div class="flex-cstyle row shine-group">
          <div id="topName">先锋导读</div>
          <div style="width: 90%; text-align: center;" id="topList">
            
          </div>
          
        </div>
        <div class="bottom-line"></div>
        <div class="sec-top" id="step">
          <a href="./index.html" target="_blank">首页</a>>
          <a href="#" target="_blank">先锋导读</a>
          
        </div>
        <div class="section" style="width:67%">
          <div class=" flex-cstyle row shine-content
        ">
              <div class="shine-set" >
                <div class="flex-cstyle row shine-title" id="setNewList">
                  <div id="topTitle">党建掠影</div>
                </div>
                <div style="width:100%;height:100%;" id="setNewListDetail">

                </div>

                     
              </div>
    
           
          </div>
          
        
        </div>
        <aside style="width:30%; margin-top: 25px;">
          <div class="shine-set shine-left" >
            <div class="flex-cstyle row" style="padding: 15px 10px; background-color: #F5F5F5;">
              <img src="./images/celect.jpg" alt="">
              <div class="shine-detail">
                <h3>
                  北海先锋
                </h3>
                <button type="button">立即收听</button>
              </div>
              
    
            </div>
            <div style="line-height: 23px; padding: 0px 10px;">
              #先锋新闻# 专稿 : 近年来 , 北海以"四个推手" 为抓手, 通过推动全覆盖, 规范化, 三帮带, 示范引领等多措并举, 有效促进该区非公企业党建工作由被动为主动的转变, 实现非公党建水平的整体提升.
            </div>
            <img src="./images/celect.jpg" alt="" style="width:100%; height: 175px;padding: 0px 10px;">
          <div class="flex-rstyle " style="height: 35px;color: #969696;line-height: 37px; padding: 0px 10px;">
              <span>3月25日 18:11 来着网页</span>
              <div class="say"><img src="./images/say.png" alt="">(12565)</div>
            </div>
          </div>
    
          <div class="shine-bottom">
            <div class="flex-cstyle row shine-title" style="background-image: url(./images/video.png); ">
              <div style="font-weight: 400; font-size: 15px;">党建视频</div>
              <span class="more">更多>></span>
            </div>
            <div class="mid-pic">
              <img src="./images/celect.jpg" alt="">
            </div>
          </div>
        </aside>
        
      </section>
      
      <div class="demo customBootstrap">
        <!-- <p>当前第 <span id="demo2-text"></span> 页</p> -->
        <ul id="demo2" class="pagination flex-style"></ul>
      </div>
    
      <section class="clearfix">
        <div class="flex-cstyle row links">
          <div>
            <span class="link-title">友情链接</span>
            <span style="color: #969696;font-size: 13px; ">Links</span>
            </div>
         
          <div class="webs">
            <span class="webs-selected">党建网站</span>
            <span>综合网站</span>
            <span>报刊网站</span>
          </div>
        </div>
          <ul class="flex-style row websites">
            <li><a href="#">共产党员网</a></li>
            <li><a href="#">中共中央组织部</a></li>
            <li><a href="#">中国党建网</a></li>
            <li><a href="#">中国共产党新闻网</a></li>
            <li><a href="#">党史党建在线</a></li>
            <li><a href="#">全国远程教育网</a></li>
            <li><a href="#">北京组工</a></li>
            <li><a href="#">新浪网</a></li>
          </ul>
         
        
      </section>
    </div>
    
    <footer >
      <div>
        <a href="#">联系我们</a>|
        <a href="#">网站地图</a>|
        <a href="#">法律申明</a>|
        <a href="#">投诉信箱</a>|
        <a href="#">免责申明</a>
        
      </div>
      <div>中共北海市委组织部主办</div>
      <div>地址 : 广西市合平路东二巷2号 邮编 : 53600</div>
      <div>桂公网安备 450502020000014号</div>
      <img src="./images/bottom.png" alt="">
    </footer>
  </div>


    

<script>
 $(function(){
      //获取url中的参数  
      function getUrlParam(name) {   
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象  
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数   
        if (r != null) return unescape(r[2]); return null; //返回参数值  
   } 
  //  type为1是党建视频
   var type = getUrlParam('type') || 0;

   var totalPage = 1;
console.log(type)
$("#some-element").busyLoad("show",state);
   if(type !== 0){
    getVideoList();
    $('#topTitle').html('党建视频');
   }else{
      //  获取党建掠影
      getSetList();
      $('#topTitle').html('党建掠影');

   }
  
   //  初始化分页
   $("#demo2").jqPaginator({
        totalPages: totalPage,
        visiblePages: 10,
        currentPage: 1,
        first: '<li class="first"><a href="javascript:void(0);">首页<\/a><\/li>',
        prev: '<li class="prev"><a href="javascript:void(0);">上一页<\/a><\/li>',
        next: '<li class="next"><a href="javascript:void(0);">下一页<\/a><\/li>',
        last: '<li class="last"><a href="javascript:void(0);">末页<\/a><\/li>',
        page: '<li class="page"><a href="javascript:void(0);">{{page}}<\/a><\/li>',
        onPageChange: function(n) {
          // $("#demo2-text").html(n);
            $('html,body').animate({scrollTop:200},'slow');

            if(type !== 0){
              // 获取党建视频
              getVideoList(n);
            }else{
                //  获取党建掠影
                getSetList(n);
            }
        }
      })

  

   function getSetList(page){

    var pageNo = page || 1;
      var data = {
        current:pageNo,
        size:20
    }
    var result=ajaxMethod('filmFestival','',data);
    console.log(result)
    
        if (result.code == 0 && result.data != null) {
            //do something
            if(result.data.size > result.data.total){
            totalPage = 1;
          }else{
            totalPage = Math.ceil(result.data.total/result.data.size);
            console.log(totalPage);
          }    
          var list = result.data.records;
          var set='';
          $('#setNewListDetail').html(set); 
          list.forEach(function(value, index ){
                 console.log(value)
                 var picList = value.pics.split(',');
                  var pic = filePath + picList[0];
                  var srt='<div class="main-new" >'+
                  '<a target="_blank" href="./bookList.html?id='+value.id+'"><h3>'+value.object+'</h3></a>'+
                  '<img  class="max" src="'+pic+'" alt=""></div>'
                  
                 
                 set += srt
                 
               })
               $('#setNewListDetail').html(set);   
              
            
        } else {
            //do something
        }
    }

    // 获取党建视频
    function getVideoList(page){
      var pageNo = page || 1;
      let that = this;
      var data = {
        current:pageNo,
        size:20
    }
    var result=ajaxMethod('partyVideo','',data);
    console.log(result)
    
        if (result.code == 0 && result.data != null) {
            //do something
            if(result.data.size > result.data.total){
            totalPage = 1;
          }else{
            totalPage = Math.ceil(result.data.total/result.data.size);
            console.log(totalPage);
          }    
          var list = result.data.records;
          var set='';
          $('#setNewListDetail').html(set); 
          list.forEach(function(value, index ){
                 console.log(value)
                 
                  var url = './video.html?id='+value.id;
                  var srt='<div class="main-new" >'+
                  '<a target="_blank" href="'+url+'"><h3>'+value.title+'</h3></a>'+
                  '<div class="flex-cstyle row main-content" >'+
                    
                    '<div class="shine-detail save">'+value.createdDate+'  </div></div></div>';
                  
                 
                 set += srt
                 
               })
      $("#some-element").busyLoad("hide");

               $('#setNewListDetail').html(set);   
              
            
        } else {
            //do something
        }
    }
    
 })

</script> 
</body>
</html>
